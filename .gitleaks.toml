# =============================================================================
# Gitleaks Configuration - Tokenizer42
# =============================================================================
# This file configures secret detection for the project.
# Install: https://github.com/gitleaks/gitleaks
# Usage: gitleaks detect --config .gitleaks.toml
# =============================================================================

title = "Tokenizer42 Gitleaks Configuration"

[extend]
# Use the default gitleaks rules as a base
useDefault = true

# =============================================================================
# Custom Rules for Blockchain Projects
# =============================================================================

[[rules]]
id = "ethereum-private-key"
description = "Detected a potential Ethereum private key"
regex = '''(?i)(0x)?[a-fA-F0-9]{64}'''
keywords = ["private_key", "privatekey", "secret_key", "secretkey"]
entropy = 3.5

[[rules]]
id = "mnemonic-phrase"
description = "Detected a potential mnemonic/seed phrase"
regex = '''(?i)(abandon|ability|able|about|above|absent)(\s+\w+){11,23}'''
keywords = ["mnemonic", "seed", "phrase", "recovery"]

[[rules]]
id = "bscscan-api-key"
description = "Detected a potential BSCScan API key"
regex = '''[A-Z0-9]{34}'''
keywords = ["bscscan", "etherscan", "api_key", "apikey"]

[[rules]]
id = "infura-api-key"
description = "Detected a potential Infura API key"
regex = '''[a-f0-9]{32}'''
keywords = ["infura", "project_id", "projectid"]

[[rules]]
id = "alchemy-api-key"
description = "Detected a potential Alchemy API key"
regex = '''[a-zA-Z0-9_-]{32}'''
keywords = ["alchemy", "api_key", "apikey"]

# =============================================================================
# Allowed Patterns (False Positives)
# =============================================================================

[allowlist]
description = "Global allowlist"

# Allow example/placeholder values
regexes = [
  '''your_private_key_here''',
  '''your_bscscan_api_key_here''',
  '''0x[0]{40}''',                    # Zero address
  '''PRIVATE_KEY=$''',                # Empty env var
  '''BSCSCAN_API_KEY=$''',            # Empty env var
  # OpenZeppelin EIP-6093 custom error names (NOT crypto algorithms)
  '''ERC20InsufficientBalance''',
  '''ERC20InsufficientAllowance''',
  '''ERC20InvalidReceiver''',
  '''ERC20InvalidSender''',
  '''ERC20InvalidApprover''',
  '''ERC20InvalidSpender''',
]

# Allow specific paths that shouldn't contain secrets
paths = [
  '''\.env\.example$''',
  '''.*test.*''',
  '''.*\.md$''',
  '''.*\.txt$''',
  '''.*\.test\.ts$''',
  '''.*\.spec\.ts$''',
]

# =============================================================================
# Commits to Skip
# =============================================================================

[allowlist.commits]
# Add commit hashes to skip if false positives were already committed
# Example: commits = ["abc123", "def456"]

# =============================================================================
# Path Exclusions
# =============================================================================

[allowlist.paths]
# Paths to completely exclude from scanning
paths = [
  '''node_modules/''',
  '''\.git/''',
  '''artifacts/''',
  '''cache/''',
  '''coverage/''',
]
